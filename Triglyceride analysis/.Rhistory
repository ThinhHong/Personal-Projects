knitr::opts_chunk$set(echo = TRUE)
library(SenSrivastava)
library(car)
library(ggplot2)
library(ggpubr)
library(whitestrap)
library(lmtest)
library(olsrr)
library(corrplot)
library(heatmaply)
library(gplots)
library(GGally)
library(tidyverse)
library(olsrr)
library(MASS)
setwd("~/")
#Read file in folder
df <- read.csv("Triglyceride.csv")
#Changes independent variables to character
df$Sex <- as.character(df$Sex)
df$HT_Trt <- as.character(df$HT_Trt)
df$Cholesterol_Trt <- as.character(df$Cholesterol_Trt)
df$Smoking <- as.character(df$Smoking)
df$Diabetes_Status <- as.character(df$Smoking)
df$Hard.CHD <- as.character(df$Hard.CHD)
#Creating Linear Model
lm_full <- lm(Triglyceride ~ ., data= df)
summary(lm_full)
#creates plots of independent variables on Tricylecride
avPlots(lm_full)
# Histrogram plot on density
hist(df$Triglyceride,freq = F,prob = T)
lines(density(df$Triglyceride))
df_log <- read.csv("Triglyceride.csv")
df_log$Triglyceride <- log(df_log$Triglyceride)
df_log$Sex <- as.character(df$Sex)
df_log$HT_Trt <- as.character(df$HT_Trt)
df_log$Cholesterol <- as.character(df$Cholesterol)
df_log$Smoking <- as.character(df$Smoking)
df_log$Diabetes_Status <- as.character(df$Smoking)
df_log$Hard.CHD <- as.character(df$Hard.CHD)
lm_log <- lm(Triglyceride ~ ., data = df_log)
par(mfrow=c(2,2))
hist(df_log$Triglyceride,freq = F,prob = T)
lines(density(df_log$Triglyceride))
plot(lm_log)
#Creates residual , normal QQ and standardized residuals plots
par(mfrow=c(2,2))
plot(lm_full)
df$res<-residuals(lm_full)
df$res_std<-rstandard(lm_full)
qqPlot(df$res_std, envelope=list(style="lines"),col.lines="red",
id=T,pch=20,grid=F,lwd=2)
white_test(lm_full)
dwtest(lm_log, alternative = "two.sided")
dwtest(lm_log, alternative = "two.sided")
dwtest(lm_log, alternative = "two.sided")
white_test(lm_log)
white_test(lm_log)
white_test(lm_log)
ols_plot_resid_stud_fit(lm_log)
ols_plot_cooksd_chart(lm_log)
ols_plot_dfbetas(lm_log)
ols_plot_dffits(lm_log)
ols_plot_resid_lev(lm_log)
df_log$DFBETAS<-dfbeta(lm_log)
df_log$DFFITS<-dffits(lm_log)
df_log$CookD<-cooks.distance(lm_log)
df_log$Lev<-hatvalues(lm_log)
df_log$CVR<-covratio(lm_log)
ind=1:20
par(mfrow=c(2,2))
plot(df_log$CVR,pch=1,xlab="Observations",ylab="Covariance Ratio",ylim=c(0.4,2.2))
abline(h=1,col="red",lty=2)
text(ind,df_log$CVR-0.05,labels=ind,cex=0.75)
x <- df_log[,2:19]
rho <- cor(x)
